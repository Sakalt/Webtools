<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>未来世界温度観測ツール</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #282c34;
            color: white;
            margin: 0;
        }
        #map-container {
            position: relative;
            width: 842px;
            height: 595px;
            overflow: hidden;
        }
        #map {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        #temperature {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1; /* 背景の温度マップ */
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            z-index: 2; /* 情報表示 */
        }
        #controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            z-index: 2; /* コントロールボタン */
        }
        #controls button, #controls input {
            background: rgba(0, 0, 0, 0.7);
            border: none;
            color: white;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        #controls button:hover, #controls input:hover {
            background: rgba(0, 0, 0, 0.9);
        }
    </style>
</head>
<body>
    <div id="map-container">
        <img id="map" src="sekai.jfif" alt="世界地図">
        <canvas id="temperature"></canvas>
        <div id="info">年代: 2028年<br>季節: 春<br>温度: 20°C</div>
        <div id="controls">
            <button id="start-button">開始</button>
            <button id="stop-button">停止</button>
            <button id="reverse-button">逆戻り</button>
            <label for="speed">速度:</label>
            <input id="speed" type="range" min="1000" max="20000" step="1000" value="5000">
            <span id="speed-value">5秒</span>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('temperature');
        const ctx = canvas.getContext('2d');
        const width = 842;
        const height = 595;

        const seasons = ['春', '夏', '秋', '冬'];
        const temperatures = {
            春: [10, 20],
            夏: [20, 30],
            秋: [10, 20],
            冬: [-10, 10]
        };

        const colors = [
            { minTemp: -35, maxTemp: -32.5, color: 'rgba(0, 0, 139, 0.5)' }, // -35 to -32.5°C (Dark Blue)
            { minTemp: -32.5, maxTemp: -30, color: 'rgba(0, 0, 255, 0.5)' }, // -32.5 to -30°C (Blue)
            { minTemp: -30, maxTemp: -27.5, color: 'rgba(0, 191, 255, 0.5)' }, // -30 to -27.5°C (Deep Sky Blue)
            { minTemp: -27.5, maxTemp: -25, color: 'rgba(0, 255, 255, 0.5)' }, // -27.5 to -25°C (Cyan)
            { minTemp: -25, maxTemp: -22.5, color: 'rgba(173, 216, 230, 0.5)' }, // -25 to -22.5°C (Light Blue)
            { minTemp: -22.5, maxTemp: -20, color: 'rgba(135, 206, 250, 0.5)' }, // -22.5 to -20°C (Sky Blue)
            { minTemp: -20, maxTemp: -17.5, color: 'rgba(176, 224, 230, 0.5)' }, // -20 to -17.5°C (Powder Blue)
            { minTemp: -17.5, maxTemp: -15, color: 'rgba(240, 248, 255, 0.5)' }, // -17.5 to -15°C (Alice Blue)
            { minTemp: -15, maxTemp: -12.5, color: 'rgba(224, 255, 255, 0.5)' }, // -15 to -12.5°C (Light Cyan)
            { minTemp: -12.5, maxTemp: -10, color: 'rgba(0, 255, 255, 0.5)' }, // -12.5 to -10°C (Cyan)
            { minTemp: -10, maxTemp: -7.5, color: 'rgba(0, 255, 127, 0.5)' }, // -10 to -7.5°C (Spring Green)
            { minTemp: -7.5, maxTemp: -5, color: 'rgba(0, 255, 0, 0.5)' }, // -7.5 to -5°C (Lime)
            { minTemp: -5, maxTemp: -2.5, color: 'rgba(50, 205, 50, 0.5)' }, // -5 to -2.5°C (Lime Green)
            { minTemp: -2.5, maxTemp: 0, color: 'rgba(34, 139, 34, 0.5)' }, // -2.5 to 0°C (Forest Green)
            { minTemp: 0, maxTemp: 2.5, color: 'rgba(124, 252, 0, 0.5)' }, // 0 to 2.5°C (Lawn Green)
            { minTemp: 2.5, maxTemp: 5, color: 'rgba(50, 205, 50, 0.5)' }, // 2.5 to 5°C (Lime Green)
            { minTemp: 5, maxTemp: 7.5, color: 'rgba(144, 238, 144, 0.5)' }, // 5 to 7.5°C (Light Green)
            { minTemp: 7.5, maxTemp: 10, color: 'rgba(0, 255, 0, 0.5)' }, // 7.5 to 10°C (Green)
            { minTemp: 10, maxTemp: 12.5, color: 'rgba(173, 255, 47, 0.5)' }, // 10 to 12.5°C (Green Yellow)
            { minTemp: 12.5, maxTemp: 15, color: 'rgba(255, 215, 0, 0.5)' }, // 12.5 to 15°C (Gold)
            { minTemp: 15, maxTemp: 17.5, color: 'rgba(255, 165, 0, 0.5)' }, // 15 to 17.5°C (Orange)
            { minTemp: 17.5, maxTemp: 20, color: 'rgba(255, 69, 0, 0.5)' }, // 17.5 to 20°C (Red Orange)
            { minTemp: 20, maxTemp: 22.5, color: 'rgba(255, 0, 0, 0.5)' }, // 20 to 22.5°C (Red)
            { minTemp: 22.5, maxTemp: 25, color: 'rgba(255, 0, 0, 0.5)' }, // 22.5 to 25°C (Red)
            { minTemp: 25, maxTemp: 27.5, color: 'rgba(255, 20, 147, 0.5)' }, // 25 to 27.5°C (Deep Pink)
            { minTemp: 27.5, maxTemp: 30, color: 'rgba(255, 105, 180, 0.5)' }, // 27.5 to 30°C (Hot Pink)
            { minTemp: 30, maxTemp: 32.5, color: 'rgba(255, 99, 71, 0.5)' }, // 30 to 32.5°C (Tomato)
            { minTemp: 32.5, maxTemp: 35, color: 'rgba(255, 69, 0, 0.5)' }, // 32.5 to 35°C (Red Orange)
            { minTemp: 35, maxTemp: 37.5, color: 'rgba(255, 0, 0, 0.5)' }, // 35 to 37.5°C (Red)
            { minTemp: 37.5, maxTemp: 40, color: 'rgba(255, 0, 0, 0.5)' }  // 37.5 to 40°C (Red)
        ];

        function getColorForTemp(temp) {
            for (let i = 0; i < colors.length; i++) {
                if (temp >= colors[i].minTemp && temp < colors[i].maxTemp) {
                    return colors[i].color;
                }
            }
            return 'rgba(0, 0, 0, 0)'; // Default to transparent if out of range
        }

        function drawTemperatureMap(year, season) {
            ctx.clearRect(0, 0, width, height);

            const centerX = width / 2;
            const centerY = height / 2;
            const maxDistance = Math.sqrt(centerX * centerX + centerY * centerY);

            for (let x = 0; x < width; x++) {
                for (let y = 0; y < height; y++) {
                    const dx = x - centerX;
                    const dy = y - centerY;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    const noise = (Math.random() - 0.5) * 5; // ノイズの範囲
                    const baseTemp = temperatures[season][0] + (temperatures[season][1] - temperatures[season][0]) * (1 - (distance / maxDistance));
                    const temp = baseTemp + noise;

                    ctx.fillStyle = getColorForTemp(temp);
                    ctx.fillRect(x, y, 1, 1);
                }
            }
        }

        let year = 2028;
        let seasonIndex = 0;
        let animationFrameId;
        let isAnimating = false;
        let speed = 5000; // default speed in milliseconds

        document.getElementById('start-button').addEventListener('click', () => {
            if (!isAnimating) {
                isAnimating = true;
                animate();
            }
        });

        document.getElementById('stop-button').addEventListener('click', () => {
            if (isAnimating) {
                cancelAnimationFrame(animationFrameId);
                isAnimating = false;
            }
        });

        document.getElementById('reverse-button').addEventListener('click', () => {
            if (isAnimating) {
                cancelAnimationFrame(animationFrameId);
                isAnimating = false;
            }
            year--;
            if (year < 2028) {
                year = 2028;
            }
            updateInfo();
            drawTemperatureMap(year, seasons[seasonIndex]);
        });

        document.getElementById('speed').addEventListener('input', (event) => {
            speed = parseInt(event.target.value, 10);
            document.getElementById('speed-value').textContent = `${Math.round(speed / 1000)}秒`;
        });

        function animate() {
            drawTemperatureMap(year, seasons[seasonIndex]);
            updateInfo();
            animationFrameId = setTimeout(() => {
                year++;
                if (year > 2038) {
                    year = 2028;
                }
                seasonIndex = (seasonIndex + 1) % seasons.length;
                animate();
            }, speed);
        }

        function updateInfo() {
            document.getElementById('info').innerHTML = `年代: ${year}年<br>季節: ${seasons[seasonIndex]}<br>温度: ${temperatures[seasons[seasonIndex]][0]}~${temperatures[seasons[seasonIndex]][1]}°C`;
        }

        drawTemperatureMap(year, seasons[seasonIndex]);
    </script>
</body>
</html>
